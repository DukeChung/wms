@using NBK.WMS.Portal.Helpers

@{
    ViewBag.Title = "新增货品单位";
}

@Html.Breadcrumb("货品单位管理", "/PackageManage/UOMMaintain", "新增货品单位")

<div class="wrapper wrapper-content animated fadeInRight ecommerce">
    <div id="AddUOM" class="ibox-content m-b-sm border-bottom">

        <form id="uomForm" class="form-horizontal">
            <div class="form-group">
                <label class="col-sm-2 control-label">计量单位代码</label>

                <div class="col-sm-10">
                    <input id="UOMCode" name="UOMCode" v-model="UOMCode" type="text" class="form-control required">
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-2 control-label">计量单位描述</label>

                <div class="col-sm-10">
                    <input id="Descr" name="Descr" v-model="Descr" type="text" class="form-control required" >
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-2 control-label">计量单位类型</label>

                <div class="col-sm-10">
                    <select class="form-control m-b" id="UomType" name="UomType" v-model="UomType"  data-placeholder="请选择">
                        @{
                            foreach (var uom in (List<SelectListItem>)ViewBag.UomList)
                            {
                                <option value="@uom.Value">@uom.Text</option>
                            }
                        }
                    </select>
                </div>
            </div>
        </form>
        <div class="ibox-footer text-right tooltip-demo">
            <a class="btn btn-sm btn-primary" id="btnAddUOM"><i class="fa fa-check-square-o"></i> 保存</a>
            <a class="btn btn-white btn-sm" id="btnReturn"><i class="fa fa-times"></i> 返回</a>
        </div>

    </div>
</div>

@section Scripts {
    <script>
        var UOMAdd = {
            uomVue: {},
            init: function () {
                var _self = this;

                _self.uomVue = new Vue({
                    el: '#AddUOM',
                    data: {
                        UOMCode: '',
                        Descr: '',
                        UomType: ''
                    }
                });

                UOMAdd.uomVue.$data.UomType = $("#UomType option:first").val();

                $("#uomForm").validate({
                    ignore: [],
                    rules: {
                        UomType: {
                            required: true
                        },
                        UOMCode: {
                            required: true,
                            maxlength: 32
                        },
                        Descr: {
                            required: true,
                            maxlength: 128
                        },
                    },
                    messages: {
                        UomType: {
                            required: "请选择"
                        }
                    }
                });

                $("#btnAddUOM").click(function () {

                    if ($("#uomForm").valid()) {
                        $.ajax({
                            url: "@Url.Action("AddUOM", "PackageManage")",
                            data: _self.uomVue.$data,
                            type: "post",
                            success: function (data) {
                                if (data.success) {
                                    msgSuccess("添加成功!");
                                    _self.backParentPage();
                                }
                                else {
                                    msgErro(data.message);
                                }
                            },
                            error: function () {
                                msgErro("操作失败！");
                            }
                        });
                    }

                })

                $("#btnReturn").click(function () {
                    _self.backParentPage();
                })

            },
            backParentPage: function () {
                window.location.href = '@Url.Action("UOMMaintain", "PackageManage")'
            }
        }

        $(function () {
            UOMAdd.init();
        })

    </script>
}